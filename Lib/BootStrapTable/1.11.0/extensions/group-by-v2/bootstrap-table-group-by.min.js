!function(n){"use strict";var i,r,u=function(n){var i=arguments,t=!0,r=1;return n=n.replace(/%s/g,function(){var n=i[r++];return typeof n=="undefined"?(t=!1,""):n}),t?n:""},f=function(n,t){var i={};return n.forEach(function(n){var r=t(n);i[r]=i[r]||[];i[r].push(n)}),i};n.extend(n.fn.bootstrapTable.defaults,{groupBy:!1,groupByField:""});var t=n.fn.bootstrapTable.Constructor,e=t.prototype.initSort,o=t.prototype.initBody,s=t.prototype.updateSelected;t.prototype.initSort=function(){var t;if(e.apply(this,Array.prototype.slice.apply(arguments)),t=this,r=[],this.options.groupBy&&this.options.groupByField!==""){this.options.sortName!=this.options.groupByField&&this.data.sort(function(n,i){return n[t.options.groupByField].localeCompare(i[t.options.groupByField])});var t=this,u=f(t.data,function(n){return[n[t.options.groupByField]]}),i=0;n.each(u,function(n,t){r.push({id:i,name:n});t.forEach(function(n){n._data||(n._data={});n._data["parent-index"]=i});i++})}};t.prototype.initBody=function(){if(i=!0,o.apply(this,Array.prototype.slice.apply(arguments)),this.options.groupBy&&this.options.groupByField!==""){var t=this,e=!1,f=0;this.columns.forEach(function(n){n.checkbox?e=!0:n.visible&&(f+=1)});this.options.detailView&&!this.options.cardView&&(f+=1);r.forEach(function(i){var r=[];r.push(u('<tr class="info groupBy expanded" data-group-index="%s">',i.id));t.options.detailView&&!t.options.cardView&&r.push('<td class="detail"><\/td>');e&&r.push('<td class="bs-checkbox">','<input name="btSelectGroup" type="checkbox" />',"<\/td>");r.push("<td",u(' colspan="%s"',f),">",i.name,"<\/td>");r.push("<\/tr>");t.$body.find("tr[data-parent-index="+i.id+"]:first").before(n(r.join("")))});this.$selectGroup=[];this.$body.find('[name="btSelectGroup"]').each(function(){var i=n(this);t.$selectGroup.push({group:i,item:t.$selectItem.filter(function(){return n(this).closest("tr").data("parent-index")===i.closest("tr").data("group-index")})})});this.$container.off("click",".groupBy").on("click",".groupBy",function(){n(this).toggleClass("expanded");t.$body.find("tr[data-parent-index="+n(this).closest("tr").data("group-index")+"]").toggleClass("hidden")});this.$container.off("click",'[name="btSelectGroup"]').on("click",'[name="btSelectGroup"]',function(i){i.stopImmediatePropagation();var r=n(this),u=r.prop("checked");t[u?"checkGroup":"uncheckGroup"](n(this).closest("tr").data("group-index"))})}i=!1;this.updateSelected()};t.prototype.updateSelected=function(){i||(s.apply(this,Array.prototype.slice.apply(arguments)),this.options.groupBy&&this.options.groupByField!==""&&this.$selectGroup.forEach(function(n){var t=n.item.filter(":enabled").length===n.item.filter(":enabled").filter(":checked").length;n.group.prop("checked",t)}))};t.prototype.getGroupSelections=function(t){var i=this;return n.grep(this.data,function(n){return n[i.header.stateField]&&n._data["parent-index"]===t})};t.prototype.checkGroup=function(n){this.checkGroup_(n,!0)};t.prototype.uncheckGroup=function(n){this.checkGroup_(n,!1)};t.prototype.checkGroup_=function(t,i){var r,u=function(){return n(this).closest("tr").data("parent-index")===t};i||(r=this.getGroupSelections(t));this.$selectItem.filter(u).prop("checked",i);this.updateRows();this.updateSelected();i&&(r=this.getGroupSelections(t));this.trigger(i?"check-all":"uncheck-all",r)}}(jQuery)
//# sourceMappingURL=bootstrap-table-group-by.min.js.map
