(function(n){"use strict";var i=!1,r=function(t){var f=t.$sortModal.selector,u=f.substr(1),i,e,r;if(!n(u).hasClass("modal")){i='  <div class="modal fade" id="'+u+'" tabindex="-1" role="dialog" aria-labelledby="'+u+'Label" aria-hidden="true">';i+='         <div class="modal-dialog">';i+='             <div class="modal-content">';i+='                 <div class="modal-header">';i+='                     <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button>';i+='                     <h4 class="modal-title" id="'+u+'Label">'+t.options.formatMultipleSort()+"<\/h4>";i+="                 <\/div>";i+='                 <div class="modal-body">';i+='                     <div class="bootstrap-table">';i+='                         <div class="fixed-table-toolbar">';i+='                             <div class="bars">';i+='                                 <div id="toolbar">';i+='                                     <button id="add" type="button" class="btn btn-default"><i class="'+t.options.iconsPrefix+" "+t.options.icons.plus+'"><\/i> '+t.options.formatAddLevel()+"<\/button>";i+='                                     <button id="delete" type="button" class="btn btn-default" disabled><i class="'+t.options.iconsPrefix+" "+t.options.icons.minus+'"><\/i> '+t.options.formatDeleteLevel()+"<\/button>";i+="                                 <\/div>";i+="                             <\/div>";i+="                         <\/div>";i+='                         <div class="fixed-table-container">';i+='                             <table id="multi-sort" class="table">';i+="                                 <thead>";i+="                                     <tr>";i+="                                         <th><\/th>";i+='                                         <th><div class="th-inner">'+t.options.formatColumn()+"<\/div><\/th>";i+='                                         <th><div class="th-inner">'+t.options.formatOrder()+"<\/div><\/th>";i+="                                     <\/tr>";i+="                                 <\/thead>";i+="                                 <tbody><\/tbody>";i+="                             <\/table>";i+="                         <\/div>";i+="                     <\/div>";i+="                 <\/div>";i+='                 <div class="modal-footer">';i+='                     <button type="button" class="btn btn-default" data-dismiss="modal">'+t.options.formatCancel()+"<\/button>";i+='                     <button type="button" class="btn btn-primary">'+t.options.formatSort()+"<\/button>";i+="                 <\/div>";i+="             <\/div>";i+="         <\/div>";i+="     <\/div>";n("body").append(n(i));t.$sortModal=n(f);e=t.$sortModal.find("tbody > tr");t.$sortModal.off("click","#add").on("click","#add",function(){var i=t.$sortModal.find(".multi-sort-name:first option").length,n=t.$sortModal.find("tbody tr").length;n<i&&(n++,t.addLevel(),t.setButtonStates())});t.$sortModal.off("click","#delete").on("click","#delete",function(){var i=t.$sortModal.find(".multi-sort-name:first option").length,n=t.$sortModal.find("tbody tr").length;n>1&&n<=i&&(n--,t.$sortModal.find("tbody tr:last").remove(),t.setButtonStates())});t.$sortModal.off("click",".btn-primary").on("click",".btn-primary",function(){var o=t.$sortModal.find("tbody > tr"),r=t.$sortModal.find("div.alert"),f=[],e=[],u,i;for(t.options.sortPriority=n.map(o,function(t){var i=n(t),r=i.find(".multi-sort-name").val(),u=i.find(".multi-sort-order").val();return f.push(r),{sortName:r,sortOrder:u}}),u=f.sort(),i=0;i<f.length-1;i++)u[i+1]==u[i]&&e.push(u[i]);if(e.length>0)r.length===0&&(r='<div class="alert alert-danger" role="alert"><strong>'+t.options.formatDuplicateAlertTitle()+"<\/strong> "+t.options.formatDuplicateAlertDescription()+"<\/div>",n(r).insertBefore(t.$sortModal.find(".bars")));else{if(r.length===1&&n(r).remove(),t.$sortModal.modal("hide"),t.options.sortName="",t.options.sidePagination==="server"){t.options.queryParams=function(n){return n.multiSort=t.options.sortPriority,n};t.initServer(t.options.silentSort);return}t.onMultipleSort()}});if((t.options.sortPriority===null||t.options.sortPriority.length===0)&&t.options.sortName&&(t.options.sortPriority=[{sortName:t.options.sortName,sortOrder:t.options.sortOrder}]),t.options.sortPriority!==null&&t.options.sortPriority.length>0){if(e.length<t.options.sortPriority.length&&typeof t.options.sortPriority=="object")for(r=0;r<t.options.sortPriority.length;r++)t.addLevel(r,t.options.sortPriority[r])}else t.addLevel(0);t.setButtonStates()}},t,u;n.extend(n.fn.bootstrapTable.defaults,{showMultiSort:!1,sortPriority:null,onMultipleSort:function(){return!1}});n.extend(n.fn.bootstrapTable.defaults.icons,{sort:"glyphicon-sort",plus:"glyphicon-plus",minus:"glyphicon-minus"});n.extend(n.fn.bootstrapTable.Constructor.EVENTS,{"multiple-sort.bs.table":"onMultipleSort"});n.extend(n.fn.bootstrapTable.locales,{formatMultipleSort:function(){return"Multiple Sort"},formatAddLevel:function(){return"Add Level"},formatDeleteLevel:function(){return"Delete Level"},formatColumn:function(){return"Column"},formatOrder:function(){return"Order"},formatSortBy:function(){return"Sort by"},formatThenBy:function(){return"Then by"},formatSort:function(){return"Sort"},formatCancel:function(){return"Cancel"},formatDuplicateAlertTitle:function(){return"Duplicate(s) detected!"},formatDuplicateAlertDescription:function(){return"Please remove or change any duplicate column."},formatSortOrders:function(){return{asc:"Ascending",desc:"Descending"}}});n.extend(n.fn.bootstrapTable.defaults,n.fn.bootstrapTable.locales);t=n.fn.bootstrapTable.Constructor;u=t.prototype.initToolbar;t.prototype.initToolbar=function(){var t,e,o,f;if(this.showToolbar=!0,t=this,e="#sortModal_"+this.$el.attr("id"),this.$sortModal=n(e),u.apply(this,Array.prototype.slice.apply(arguments)),this.options.showMultiSort){o=this.$toolbar.find(">.btn-group").first();f=this.$toolbar.find("div.multi-sort");f.length||(f='  <button class="multi-sort btn btn-default'+(this.options.iconSize===undefined?"":" btn-"+this.options.iconSize)+'" type="button" data-toggle="modal" data-target="'+e+'" title="'+this.options.formatMultipleSort()+'">',f+='     <i class="'+this.options.iconsPrefix+" "+this.options.icons.sort+'"><\/i>',f+="<\/button>",o.append(f),r(t));this.$el.on("sort.bs.table",function(){i=!0});this.$el.on("multiple-sort.bs.table",function(){i=!1});this.$el.on("load-success.bs.table",function(){i||t.options.sortPriority===null||typeof t.options.sortPriority!="object"||t.onMultipleSort()});this.$el.on("column-switch.bs.table",function(n,i){for(var u=0;u<t.options.sortPriority.length;u++)t.options.sortPriority[u].sortName===i&&t.options.sortPriority.splice(u,1);t.assignSortableArrows();t.$sortModal.remove();r(t)});this.$el.on("reset-view.bs.table",function(){i||t.options.sortPriority===null||typeof t.options.sortPriority!="object"||t.assignSortableArrows()})}};t.prototype.onMultipleSort=function(){var t=this,i=function(n,t){return n>t?1:n<t?-1:0},r=function(r,u){for(var s=[],h=[],o=0;o<t.options.sortPriority.length;o++){var c=t.options.sortPriority[o].sortOrder==="desc"?-1:1,f=r[t.options.sortPriority[o].sortName],e=u[t.options.sortPriority[o].sortName];(f===undefined||f===null)&&(f="");(e===undefined||e===null)&&(e="");n.isNumeric(f)&&n.isNumeric(e)&&(f=parseFloat(f),e=parseFloat(e));typeof f!="string"&&(f=f.toString());s.push(c*i(f,e));h.push(c*i(e,f))}return i(s,h)};this.data.sort(function(n,t){return r(n,t)});this.initBody();this.assignSortableArrows();this.trigger("multiple-sort")};t.prototype.addLevel=function(t,i){var f=t===0?this.options.formatSortBy():this.options.formatThenBy(),r,u;this.$sortModal.find("tbody").append(n("<tr>").append(n("<td>").text(f)).append(n("<td>").append(n('<select class="form-control multi-sort-name">'))).append(n("<td>").append(n('<select class="form-control multi-sort-order">'))));r=this.$sortModal.find(".multi-sort-name").last();u=this.$sortModal.find(".multi-sort-order").last();n.each(this.columns,function(n,t){if(t.sortable===!1||t.visible===!1)return!0;r.append('<option value="'+t.field+'">'+t.title+"<\/option>")});n.each(this.options.formatSortOrders(),function(n,t){u.append('<option value="'+n+'">'+t+"<\/option>")});i!==undefined&&(r.find('option[value="'+i.sortName+'"]').attr("selected",!0),u.find('option[value="'+i.sortOrder+'"]').attr("selected",!0))};t.prototype.assignSortableArrows=function(){for(var t,i=this,u=i.$header.find("th"),r=0;r<u.length;r++)for(t=0;t<i.options.sortPriority.length;t++)n(u[r]).data("field")===i.options.sortPriority[t].sortName&&n(u[r]).find(".sortable").removeClass("desc asc").addClass(i.options.sortPriority[t].sortOrder)};t.prototype.setButtonStates=function(){var t=this.$sortModal.find(".multi-sort-name:first option").length,n=this.$sortModal.find("tbody tr").length;n==t&&this.$sortModal.find("#add").attr("disabled","disabled");n>1&&this.$sortModal.find("#delete").removeAttr("disabled");n<t&&this.$sortModal.find("#add").removeAttr("disabled");n==1&&this.$sortModal.find("#delete").attr("disabled","disabled")}})(jQuery)
//# sourceMappingURL=bootstrap-table-multiple-sort.min.js.map
